syntax = "proto3";

package resume;

option go_package = "github.com/iprotoresume/shared/proto";

// ResumeData represents the structured data of a user's resume.
message ResumeData {
  string full_name = 1;
  string email = 2;
  string phone = 3;
  string summary = 4;
  repeated string skills = 5;
  repeated Experience experience = 6;
  repeated Education education = 7;
  repeated Project projects = 8;
  repeated Certificate certificates = 9;
  
  // Additional profile fields
  string job_title = 10;
  string location = 11;
  string linkedin = 12;
  string github = 13;
  string website = 14;
  string profile_image = 18; // Base64 encoded image
  
  // Structured data
  repeated SkillGroup skill_groups = 15;
  repeated Language languages = 16;
  repeated Achievement achievements = 17;
}

message Experience {
  string title = 1;
  string company = 2;
  string start_date = 3;
  string end_date = 4;
  string description = 5;
}

message Education {
  string degree = 1;
  string institution = 2;
  string graduation_date = 3;
}

message Project {
  string title = 1;
  string description = 2;
  repeated string tech_stack = 3;
  string date = 4;
  string location = 5;
}

message Certificate {
  string name = 1;
  string issuer = 2;
  string date = 3;
  string link = 4;
}

message SkillGroup {
  string category = 1;
  repeated string items = 2;
}

message Language {
  string language = 1;
  string proficiency = 2;
}

message Achievement {
  string title = 1;
  string description = 2;
}

// TailorRequest is used to request a tailored resume based on a job description.
message TailorRequest {
  ResumeData original_resume = 1;
  string job_description = 2;
}

message TailorResponse {
  ResumeData tailored_resume = 1;
  string cover_letter = 2;
}

service AIService {
  rpc TailorResume (TailorRequest) returns (TailorResponse);
  rpc AnalyzeResume (AnalyzeResumeRequest) returns (AnalyzeResumeResponse);
  rpc GenerateInterviewQuestions (InterviewPrepRequest) returns (InterviewPrepResponse);
}

// ... existing messages ...

message InterviewPrepRequest {
  ResumeData resume = 1;
  string job_description = 2;
}

message InterviewQuestion {
  string question = 1;
  string type = 2; // Technical, Behavioral, Soft Skills
  string answer_guide = 3;
}

message InterviewPrepResponse {
  repeated InterviewQuestion questions = 1;
}

message AnalyzeResumeRequest {
  ResumeData resume = 1;
  string job_description = 2;
}

message AnalyzeResumeResponse {
  int32 score = 1;
  repeated string feedback = 2;
  repeated string missing_keywords = 3;
  string reasoning = 4;
}

service ResumePersistenceService {
  rpc SaveResume (SaveResumeRequest) returns (SavedResume);
  rpc ListResumes (ListResumesRequest) returns (ListResumesResponse);
  rpc DeleteResume (DeleteResumeRequest) returns (DeleteResumeResponse);
}

message SavedResume {
  string id = 1;
  ResumeData resume_data = 2;
  repeated string tags = 3;
  string version = 4;
  string created_at = 5;
}

message SaveResumeRequest {
  ResumeData resume = 1;
  repeated string tags = 2;
  string version = 3;
}

message ListResumesRequest {
  repeated string tags = 1;
}

message ListResumesResponse {
  repeated SavedResume resumes = 1;
}

message DeleteResumeRequest {
  string id = 1;
}

message DeleteResumeResponse {
  bool success = 1;
}
